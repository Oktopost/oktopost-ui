<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>OUI</title>

    <link href="font/entypo.css" media="screen" rel="stylesheet" type="text/css">
    <link href="dist/okto-ui.css" media="screen" rel="stylesheet" type="text/css">
</head>
<body>
    
   <a href="" class="modal">Modal Big</a>
   <a href="" class="dialog">Confirm</a>

   <a href="" class="menu" style="float: right">Toggle Menu</a>

   <a href="" class="toast">Show Message</a>

   <div class="my-menu hidden">
        <a href="">My menu</a>
   </div>


   <div class="small-modal hidden">
        <div class="head">
            <h2>Small Modal</h2>
            <a href="" data-oui-modal-close>X</a>
        </div>
        <div class="body">
            <a class="popup-toggle" href="#">Popup menu</a>
            <p>Hello</p>
        </div>
   </div>
   <div class="big-modal hidden">
        <div class="head">
            <h2>Big Modal</h2>
            <a href="" data-oui-modal-close>X</a>
        </div>
        <div class="body">
            <a href="">Open small modal</a>
        </div>
   </div>
   
   <div class="clear:both"></div>
   
   <div id="positioner-container" style="background-color: #CCCCCC; width: 590px; height: 400px; margin-top: 150px; position: relative">
		<div id="related" style="width:100px; position: absolute; height: 100px; left: 170px; top: 130px; background-color: #5b8c00">
			related
		</div>
   </div>

   

    <script src="vendor/jquery/dist/jquery.min.js"></script>
    <script src="vendor/handlebars/handlebars.runtime.min.js"></script>
    <script src="vendor/oktopost-namespace/web/namespace.js"></script>
    <script src="vendor/plankton/plankton-min.js"></script>
    <script src="vendor/oktopost-duct/duct.js"></script>

    <script src="vendor/oktopost-classy/web/namespace.js"></script>
    <script src="vendor/oktopost-classy/web/Classify.js"></script>
    <script src="vendor/oktopost-classy/web/Enum.js"></script>
    <script src="vendor/oktopost-classy/web/Singleton.js"></script>

    <script src="dist/okto-ui-templates.js"></script>
    <script src="dist/okto-ui.js"></script>
    
    <script>
        (function () {
            var Dialog = window.OUI.components.Dialog;
            var Modal = window.OUI.components.Modal;
            var Menu = window.OUI.components.Menu;
            var Toast = window.OUI.components.Toast;


            $('a.toast').on('click', function (e) {
                e.preventDefault();
                var message = new Toast(3000);

                message.add('Lorem ipsum dolor sit amet, eos at iusto salutatus pri. Ei vim stet');
                message.onAdd(function (id) {
                    console.log('added ' + id);
                });
                message.onDismiss(function (id) {
                    console.log('dismissed ' + id);
                });
            });
            

            var myMenu = new Menu($('a.menu'), $('div.my-menu').html(), 'my-menu');
            
            myMenu.onAfterOpen(function (container) {
                var subMenu = new Menu(
                    container.find('a.menu'), 
                    $('div.my-menu').html(), 
                    'my-sub-menu');
            });

            $('a.dialog').on('click', function (e) {
                e.preventDefault();
                
                var dialog = new Dialog('YES', 'NO');
                
                dialog.onConfirm(function () {
                    console.log('YES');
                });

                dialog.open('Are you sure?');
            });

            $('a.modal').on('click', function (e) {
                e.preventDefault();

                var bigContents = $('div.big-modal').html();
                var bigModal = new Modal(bigContents, 'big');

                bigModal.onAfterOpen(function (container) {
                    container.find('div.body a').on('click', function (e) {
                        e.preventDefault();

                        var smallContents = $('div.small-modal').html();
                        var smallModal = new Modal(smallContents, 'small');
                        smallModal.onAfterOpen(function (smallModalContainer) {
                            new Menu(
                                smallModalContainer.find('a.popup-toggle'), 
                                $('div.my-menu').html(), 
                                'my-menu');
                        });
                        smallModal.open();
                    });
                });

                bigModal.open();
            });
            
            var RoundPosition = window.OUI.core.positioning.prepared.RoundPosition;
            var TargetPosition = window.OUI.core.positioning.enum.TargetPosition;
            var TargetSide = window.OUI.core.positioning.enum.TargetSide;
            
			var $target = $('<div />', {
				text: 'positioned div',
				style: 'width:150px; height: 80px; background-color: #1DA1F3; position: absolute'
			});

			var $container = $('#positioner-container');

			var options = {
				container: $container,
				containerOffset: 10,
				relatedElement: document.getElementById('related'),
				relatedOffset: 5,
				targetElement: $target,
				targetOffset: 0,
				isAbsolute: true,
                initialPosition: TargetPosition.bottom,
                initialSide: TargetSide.left
			};

			var pos = RoundPosition.get(options);

			$target.css({top: pos.y, left: pos.x});

			$container.append($target);            
        })();        
    </script>

</body>
</html>